
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Subcommands and the App Â· CLI11 Tutorial</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Henry Schreiner">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-term/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="an-advanced-example.html" />
    
    
    <link rel="prev" href="validators.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="installation.html">
            
                <a href="installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="basics.html">
            
                <a href="basics.html">
            
                    
                    Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="flags.html">
            
                <a href="flags.html">
            
                    
                    Flags
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="options.html">
            
                <a href="options.html">
            
                    
                    Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="validators.html">
            
                <a href="validators.html">
            
                    
                    Validators
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.7" data-path="subcommands.html">
            
                <a href="subcommands.html">
            
                    
                    Subcommands and the App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="an-advanced-example.html">
            
                <a href="an-advanced-example.html">
            
                    
                    An advanced example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="config.html">
            
                <a href="config.html">
            
                    
                    Configuration files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="formatting.html">
            
                <a href="formatting.html">
            
                    
                    Formatting help output
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="toolkits.html">
            
                <a href="toolkits.html">
            
                    
                    Toolkits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="advanced-topics.html">
            
                <a href="advanced-topics.html">
            
                    
                    Advanced topics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="internals.html">
            
                <a href="internals.html">
            
                    
                    Internals
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Subcommands and the App</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="subcommands-and-the-app">Subcommands and the App</h1>
<p>Subcommands are keyword that invoke a new set of options and features. For example, the <code>git</code>
command has a long series of subcommands, like <code>add</code> and <code>commit</code>. Each can have its own options
and implementations. This chapter will focus on implementations that are contained in the same
C++ application, though the system git uses to extend the main command by calling other commands
in separate executables is supported too; that&apos;s called &quot;Prefix commands&quot; and is included at the
end of this chapter.</p>
<h2 id="the-parent-app">The parent App</h2>
<p>We&apos;ll start by discussing the parent <code>App</code>. You&apos;ve already used it quite a bit, to create
options and set option defaults. There are several other things you can do with an <code>App</code>, however.</p>
<p>You are given a lot of control the help output. You can set a footer with <code>app.footer(&quot;My Footer&quot;)</code>.
You can replace the default help print when a <code>ParseError</code> is thrown with <code>app.set_failure_message(CLI::FailureMessage::help)</code>.
The default is <code>CLI:::FailureMessage::simple</code>, and you can easily define a new one. Just make a (lambda) function that takes an App pointer
and a reference to an error code (even if you don&apos;t use them), and returns a string.</p>
<h2 id="adding-a-subcommand">Adding a subcommand</h2>
<p>Subcommands can be added just like an option:</p>
<pre><code class="lang-cpp">CLI::App* sub = app.add_subcommand(<span class="hljs-string">&quot;sub&quot;</span>, <span class="hljs-string">&quot;This is a subcommand&quot;</span>);
</code></pre>
<p>The subcommand should have a name as the first argument, and a little description for the
second argument. A pointer to the internally stored subcommand is provided; you usually will
be capturing that pointer and using it later (though you can use callbacks if you prefer). As
always, feel free to use <code>auto sub = ...</code> instead of naming the type.</p>
<p>You can check to see if the subcommand was received on the command line several ways:</p>
<pre><code class="lang-cpp"><span class="hljs-keyword">if</span>(*sub) ...
<span class="hljs-keyword">if</span>(sub-&gt;parsed()) ...
<span class="hljs-keyword">if</span>(app.got_subcommand(sub)) ...
<span class="hljs-keyword">if</span>(app.got_subcommand(<span class="hljs-string">&quot;sub&quot;</span>)) ...
</code></pre>
<p>You can also get a list of subcommands with <code>get_subcommands()</code>, and they will be in parsing order.</p>
<p>There are a lot of options that you can set on a subcommand; in fact,
subcommands have exactly the same options as your main app, since they are actually
the same class of object (as you may have guessed from the type above). This has the
pleasant side affect of making subcommands infinitely nestable.</p>
<h2 id="required-subcommands">Required subcommands</h2>
<p>Each App has controls to set the number of subcommands you expect. This is controlled by:</p>
<pre><code class="lang-cpp">app.require_subcommand(<span class="hljs-comment">/* min */</span> <span class="hljs-number">0</span>, <span class="hljs-comment">/* max */</span> <span class="hljs-number">1</span>);
</code></pre>
<p>If you set the max to 0, CLI11 will allow an unlimited number of subcommands. After the (non-unlimited) maximum
is reached, CLI11 will stop trying to match subcommands. So the if you pass &quot;<code>one two</code>&quot; to a command, and both <code>one</code>
and <code>two</code> are subcommands, it will depend on the maximum number as to whether the &quot;<code>two</code>&quot; is a subcommand or an argument to the
&quot;<code>one</code>&quot; subcommand.</p>
<p>As a shortcut, you can also call the <code>require_subcommand</code> method with one argument; that will be the fixed number of subcommands if positive, it
will be the maximum number if negative. Calling it without an argument will set the required subcommands to 1 or more.</p>
<p>The maximum number of subcommands is inherited by subcommands. This allows you to set the maximum to 1 once at the beginning on the parent app if you only want single subcommands throughout your app. You should keep this in mind, if you are dealing with lots of nested subcommands.</p>
<h2 id="using-callbacks">Using callbacks</h2>
<p>You&apos;ve already seen how to check to see what subcommands were given. It&apos;s often much easier, however, to just define the code you want to run when you are making your parser, and not run a bunch of code after <code>CLI11_PARSE</code> to analyse the state (Procedural! Yuck!). You can do that with lambda functions. A <code>std::function&lt;void()&gt;</code> callback <code>.callback()</code> is provided, and CLI11 ensures that all options are prepared and usable by reference capture before entering the callback. An
example is shown below in the <code>geet</code> program.</p>
<h2 id="inheritance-of-defaults">Inheritance of defaults</h2>
<p>The following values are inherited when you add a new subcommand. This happens at the point the subcommand is created:</p>
<ul>
<li>The name and description for the help flag</li>
<li>The footer</li>
<li>The failure message printer function</li>
<li>Option defaults</li>
<li>Allow extras</li>
<li>Prefix command</li>
<li>Ignore case</li>
<li>Ignore underscore</li>
<li>Allow Windows style options</li>
<li>Fallthrough</li>
<li>Group name</li>
<li>Max required subcommands</li>
</ul>
<h2 id="special-modes">Special modes</h2>
<p>There are several special modes for Apps and Subcommands.</p>
<h3 id="allow-extras">Allow extras</h3>
<p>Normally CLI11 throws an error if you don&apos;t match all items given on the command line. However, you can enable <code>allow_extras()</code>
to instead store the extra values in <code>.remaining()</code>. You can get all remaining options including those in contained subcommands recursively in the original order with <code>.remaining(true)</code>.
<code>.remaining_size()</code> is also provided; this counts the size but ignores the <code>--</code> special separator if present.</p>
<h3 id="fallthrough">Fallthrough</h3>
<p>Fallthrough allows an option that does not match in a subcommand to &quot;fall through&quot; to the parent command; if that parent
allows that option, it matches there instead. This was added to allow CLI11 to represent models:</p>
<pre><code class="lang-term"><pre class="term t-default t-fade"><button class="btn t-copy" data-clipboard-text="./my_program my_model_1 --model_flag --shared_flag"><svg class="octicon octicon-clippy" viewbox="0 0 14 16" version="1.1" width="14" height="14" aria-hidden="true"><path fill-rule="evenodd" d="M2 13h4v1H2v-1zm5-6H2v1h5V7zm2 3V8l-3 3 3 3v-2h5v-2H9zM4.5 9H2v1h2.5V9zM2 12h2.5v-1H2v1zm9 1h1v2c-.02.28-.11.52-.3.7-.19.18-.42.28-.7.3H1c-.55 0-1-.45-1-1V4c0-.55.45-1 1-1h3c0-1.11.89-2 2-2 1.11 0 2 .89 2 2h3c.55 0 1 .45 1 1v5h-1V6H1v9h10v-2zM2 5h8c0-.55-.45-1-1-1H8c-.55 0-1-.45-1-1s-.45-1-1-1-1 .45-1 1-.45 1-1 1H3c-.55 0-1 .45-1 1z"/></svg></button><span class="t-line t-prompt-line"><span class="t-prompt">gitbook</span><span class="t-pathsep">:</span><span class="t-path">code </span><span class="t-delimiter">$ </span><span class="t-command">./my_program my_model_1 --model_flag --shared_flag</span>
</span></pre></code></pre>
<p>Here, <code>--shared_option</code> was set on the main app, and on the command line it &quot;falls through&quot; <code>my_model_1</code> to match on the main app.</p>
<h3 id="prefix-command">Prefix command</h3>
<p>This is a special mode that allows &quot;prefix&quot; commands, where the parsing completely stops when it gets to an unknown option. Further unknown options are ignored, even if they could match. Git is the traditional example for prefix commands; if you run git with an unknown subcommand, like &quot;<code>git thing</code>&quot;, it then calls another command called &quot;<code>git-thing</code>&quot; with the remaining options intact.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="validators.html" class="navigation navigation-prev " aria-label="Previous page: Validators">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="an-advanced-example.html" class="navigation navigation-next " aria-label="Next page: An advanced example">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Subcommands and the App","level":"1.7","depth":1,"next":{"title":"An advanced example","level":"1.8","depth":1,"path":"chapters/an-advanced-example.md","ref":"chapters/an-advanced-example.md","articles":[]},"previous":{"title":"Validators","level":"1.6","depth":1,"path":"chapters/validators.md","ref":"chapters/validators.md","articles":[]},"dir":"ltr"},"config":{"plugins":["include-codeblock","term","hints"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"search":{},"term":{"copyButtons":true,"fade":true,"lineStyles":true,"prompt":"(?<prompt>[^\\$^#^:]*)(?<pathsep>:?)(?<path>[^\\$^#]*?)(?<delimiter>[\\$#] )(?<command>.*)$","style":"default"},"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"include-codeblock":{"check":false,"edit":false,"fixlang":true,"lang":"","template":"default","theme":"chrome","unindent":true},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Henry Schreiner","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"CLI11 Tutorial","gitbook":"*","description":"A set of examples and detailed information about CLI11"},"file":{"path":"chapters/subcommands.md","mtime":"2019-09-06T21:40:05.668Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-09-06T21:46:06.527Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-term/clipboard.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-term/initclip.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-term/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

